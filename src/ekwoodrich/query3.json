{"_id":"_design/query3","_rev":"12-9750104437176e22d789292a90594742","views":{"avg_by_five_min":{"reduce":"function(keys, values, rereduce) {\n    if (!rereduce) {\n        var length = values.length\n        return [sum(values) / length, length]\n    } else {\n        var length = sum(values.map(function(v){return v[1]}));\n        var avg = sum(values.map(function(v){\n            return v[0] * (v[1] / length)\n        }));\n        return [avg, length]\n    }\n}\n","map":"function(doc) {\r\n    if (doc.docType == \"loop\") {\r\n      if(Number(doc.speed) !=0 && doc.locationtext == 'Foster NB'){\r\n        if(doc.length) {\r\n        \r\n          year = Number(doc.starttime.substring(0,4));\r\n          month = Number(doc.starttime.substring(5,7));\r\n          day = Number(doc.starttime.substring(8,10));\r\n          hour = Number(doc.starttime.substring(11,13));\r\n          minute = Number(doc.starttime.substring(14,16));\r\n          \r\n          if(year == 2011 && month == 9 && day ==15) {\r\n            emit(Math.floor(minute/5)*5, (doc.length/doc.speed)*3600);\r\n          }\r\n        }\r\n      }\r\n    }\r\n}"}}}
